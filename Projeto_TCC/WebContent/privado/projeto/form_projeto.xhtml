<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui" template="/templates/layout.xhtml">



	<ui:define name="content">
		<h1 class="aw-page-title">Novo Projeto</h1>

		<h:form id="frm">

			<p:toolbar>
				<p:toolbarGroup>
					<p:commandButton value="Salvar" action="#{controleProjeto.gravar}"
						process="@this capaPanel" update="@form" />
				</p:toolbarGroup>
			</p:toolbar>

			<p:messages autoUpdate="false" />

			<div class="ui-fluid">
				<p:panelGrid id="capaPanel" columns="2" layout="grid"
					style="margin-top: 20px; margin-bottom: 40px"
					styleClass="panelgrid-noborder"
					columnClasses="ui-grid-col-2, ui-grid-col-4, ui-grid-col-2, ui-grid-col-4">

					<p:outputLabel value="Nome" />
					<h:inputText value="#{controleProjeto.objeto.nome}" size="40"
						maxlength="40" />
					<p:outputLabel value="Descrição" />
					<h:inputTextarea value="#{controleProjeto.objeto.descricao}"
						rows="5" cols="60" />
					<p:outputLabel value="Início" />
					<p:calendar value="#{controleProjeto.objeto.inicio}"
						pattern="dd/MM/yyyy" locale="pt_BR">
						<f:converter converterId="converterCalendar" />
					</p:calendar>
					<p:outputLabel value="Fim" />
					<p:calendar value="#{controleProjeto.objeto.fim}"
						pattern="dd/MM/yyyy" locale="pt_BR">
						<f:converter converterId="converterCalendar" />
					</p:calendar>
					<p:outputLabel value="Ativo" />
					<h:selectBooleanCheckbox value="#{controleProjeto.objeto.ativo}" />
					<p:outputLabel value="Setor" />
					<p:selectOneMenu value="#{controleProjeto.objeto.setor}"
						converter="#{controleProjeto.converterSetor}">
						<f:selectItem itemLabel="Selecione um setor"
							noSelectionOption="true" />
						<f:selectItems value="#{controleProjeto.dao.listarTodosSetor()}" />
					</p:selectOneMenu>

				</p:panelGrid>
			</div>

			<p:commandButton value="Adicionar Funcionário"
				action="#{controleProjeto.adicionarFuncionario()}"
				oncomplete="PF('itemDialog').show()" process="@this"
				update="itemPanel">
				<p:resetInput target="itemPanel" />
			</p:commandButton>


			<p:dataTable id="listaFuncionarios"
				value="#{controleProjeto.objeto.funcionarios}" var="obj"
				emptyMessage="Nenhum item adicionado." reflow="true"
				style="margin-top: 10px">


				<p:column headerText="Funcionário">
					<h:outputText value="#{obj.funcionario.nome}" />
				</p:column>
				<p:column headerText="Carga Horária">
					<h:outputText value="#{obj.cargaHoraria}" />
				</p:column>
				<p:column headerText="Gestor">
					<h:outputText value="#{obj.gestor == true ? 'Sim' : 'Não'}" />
				</p:column>
				<p:column headerText="Início Participação">
					<h:outputText value="#{obj.inicioParticipacao}">
						<f:converter converterId="converterCalendar" />
					</h:outputText>
				</p:column>
				<p:column headerText="Fim Participação">
					<h:outputText value="#{obj.fimParticipacao}">
						<f:converter converterId="converterCalendar" />
					</h:outputText>
				</p:column>

				<p:column headerText="Excluir">
					<p:commandButton
						action="#{controleProjeto.removerFuncionario(obj)}"
						value="Excluir"
						onclick="if (!confirm('Confirma a exclusão?')) return false">
						<f:ajax execute="@this" render="@form" />
					</p:commandButton>
				</p:column>
			</p:dataTable>

			<p:dialog widgetVar="itemDialog" header="Novo Funcionário"
				resizable="false" style="min-width: 300px" responsive="true">

				<h:panelGroup id="itemPanel" layout="block" styleClass="ui-fluid">
					<p:messages id="msgDialog" autoUpdate="false" />

					<p:panelGrid columns="2" layout="grid"
						styleClass="panelgrid-noborder"
						columnClasses="ui-grid-col-4, ui-grid-col-8">

						<p:outputLabel value="Funcionário" for="funcionario" />
						<p:inputText id="funcionarioo"
							value="#{obj.funcionario.nome}" />
					
					<p:outputLabel />
						<p:commandButton value="Adicionar"
							action="#{controleProjeto.addFunc == true}"
							process="itemPanel" update="itemPanel itensTable"
							oncomplete="if (!args.validationFailed) PF('itemDialog').hide()" />

					</p:panelGrid>

				</h:panelGroup>

			</p:dialog>


		</h:form>
	</ui:define>

</ui:composition>